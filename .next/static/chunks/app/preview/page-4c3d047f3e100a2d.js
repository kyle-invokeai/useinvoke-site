(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[639],{9239:function(e,t,s){Promise.resolve().then(s.bind(s,9016))},9016:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return i}});var a=s(3827),n=s(4090),r=s(8792),o=s(5313);function l(){let e=(0,o.useSearchParams)(),[t,s]=(0,n.useState)(""),[l,i]=(0,n.useState)(""),[c,d]=(0,n.useState)([]),[u,x]=(0,n.useState)(!1),[m,h]=(0,n.useState)(""),p=(0,n.useRef)(null),[f,b]=(0,n.useState)(!0),[g,v]=(0,n.useState)(!1),[w,j]=(0,n.useState)(""),[y,N]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(async()=>{let t=e.get("phone")||"";if(!t){let e=localStorage.getItem("invoke_preview_phone");e&&(t=e)}if(!t){b(!1),j("No phone number provided");return}if(s(t),"+19999999999"===t){N(!0),v(!0),b(!1),localStorage.setItem("invoke_preview_phone",t);return}try{let e=await fetch("/api/preview/access?phone=".concat(encodeURIComponent(t))),s=await e.json();e.ok&&s.allowed?(v(!0),N(s.demo||!1),localStorage.setItem("invoke_preview_phone",t)):(v(!1),j(s.error||"Access denied"))}catch(e){v(!1),j("Failed to verify access")}finally{b(!1)}})()},[e]),(0,n.useEffect)(()=>{var e;null===(e=p.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[c]);let S=async()=>{if(!l.trim()||!t||u)return;let e=l.trim();i(""),x(!0),h("");let s={id:Date.now().toString(),direction:"inbound",body:e,created_at:new Date().toISOString()};d(e=>[...e,s]);try{let s=await fetch("/api/invoke",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({from:t,body:e,channel:y?"demo":"web"})}),a=await s.json();if(s.ok){let e={id:(Date.now()+1).toString(),direction:"outbound",body:a.reply,created_at:new Date().toISOString()};d(t=>[...t,e])}else h(a.error||"Failed to get response")}catch(e){h("Failed to send message. Please try again.")}finally{x(!1)}},k=e=>new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return(0,a.jsxs)("div",{className:"min-h-screen bg-slate-950 text-slate-200 flex flex-col",children:[(0,a.jsxs)("header",{className:"bg-slate-900 border-b border-slate-800 px-4 py-3 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(r.default,{href:"/",className:"text-xl font-bold text-white tracking-tight",children:"Invoke"}),(0,a.jsx)("span",{className:"text-slate-500",children:"|"}),(0,a.jsx)("span",{className:"text-sm text-slate-400",children:"Preview"})]}),(0,a.jsx)("div",{className:"flex items-center gap-4",children:(0,a.jsx)("form",{onSubmit:e=>{e.preventDefault(),t&&(localStorage.setItem("invoke_preview_phone",t),window.location.href="/preview?phone=".concat(encodeURIComponent(t)))},className:"flex items-center gap-2",children:(0,a.jsx)("input",{type:"tel",value:t,onChange:e=>s(e.target.value),placeholder:"Phone number",className:"px-3 py-1.5 bg-slate-800 border border-slate-700 rounded text-sm text-white placeholder-slate-500 focus:outline-none focus:ring-1 focus:ring-blue-500 w-40"})})})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto px-4 py-6",children:(0,a.jsxs)("div",{className:"max-w-2xl mx-auto space-y-4",children:[0===c.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-blue-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)("svg",{className:"w-8 h-8 text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-white mb-2",children:y?"Demo Mode":"Welcome to Invoke Preview"}),(0,a.jsx)("p",{className:"text-slate-400 max-w-md mx-auto",children:y?"This is a demo with sample data. Type a message below to try the conversation flow.":'This simulates the SMS experience. Type a message below to start the conversation. Try typing "hello" or "//invoke" to begin.'})]}),c.map(e=>(0,a.jsx)("div",{className:"flex ".concat("inbound"===e.direction?"justify-end":"justify-start"),children:(0,a.jsxs)("div",{className:"max-w-[80%] rounded-2xl px-4 py-3 ".concat("inbound"===e.direction?"bg-blue-600 text-white rounded-br-md":"bg-slate-800 text-slate-200 rounded-bl-md"),children:[(0,a.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:e.body}),(0,a.jsx)("p",{className:"text-xs mt-1 ".concat("inbound"===e.direction?"text-blue-200":"text-slate-500"),children:k(e.created_at)})]})},e.id)),m&&(0,a.jsx)("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-3 text-center",children:(0,a.jsx)("p",{className:"text-sm text-red-400",children:m})}),(0,a.jsx)("div",{ref:p})]})}),(0,a.jsxs)("div",{className:"bg-slate-900 border-t border-slate-800 px-4 py-4",children:[(0,a.jsxs)("div",{className:"max-w-2xl mx-auto flex gap-2",children:[(0,a.jsx)("input",{type:"text",value:l,onChange:e=>i(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),S())},placeholder:t?"Type a message...":"Enter phone number first...",disabled:!t||u,className:"flex-1 px-4 py-3 bg-slate-800 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"}),(0,a.jsx)("button",{onClick:S,disabled:!t||!l.trim()||u,className:"px-6 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:u?(0,a.jsxs)("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:"Send"}),(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})]})})]}),(0,a.jsx)("p",{className:"max-w-2xl mx-auto mt-2 text-xs text-slate-500 text-center",children:y?"Demo mode - No data is saved to the database.":"This is a preview of the SMS experience. Messages are not sent to your actual phone."})]})]})}function i(){return(0,a.jsx)(n.Suspense,{fallback:(0,a.jsx)("div",{className:"min-h-screen bg-slate-950 flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}),children:(0,a.jsx)(l,{})})}},8792:function(e,t,s){"use strict";s.d(t,{default:function(){return n.a}});var a=s(5250),n=s.n(a)}},function(e){e.O(0,[250,971,69,744],function(){return e(e.s=9239)}),_N_E=e.O()}]);